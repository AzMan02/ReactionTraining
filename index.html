html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë°˜ì‘ í›ˆë ¨ Pro (Voice Control)</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#222">
    <style>
        :root { --bg-color: #222; }
        body {
            margin: 0; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            height: 100vh; width: 100vw;
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color); color: white;
            transition: background-color 0.15s ease-out; 
            touch-action: manipulation; overflow: hidden;
        }
        #info { 
            position: absolute; top: 5%; text-align: center; 
            line-height: 1.4; z-index: 10; width: 90%;
            font-size: clamp(0.9rem, 2vw, 1.2rem);
            background: rgba(0,0,0,0.3); padding: 10px; border-radius: 12px;
        }
        #mic-status { color: #ff4757; font-weight: bold; margin-bottom: 5px; }
        
        /* ê°€ë¡œ/ì„¸ë¡œ ëŒ€ì‘ í…ìŠ¤íŠ¸ í¬ê¸° */
        #direction-text { 
            font-size: clamp(10rem, 40vw, 25rem); 
            font-weight: 900; user-select: none;
            line-height: 1;
        }
        .val { color: #fbc531; font-weight: bold; }
        
        /* ê°€ë¡œ ëª¨ë“œì¼ ë•Œ info ìœ„ì¹˜ ì¡°ì • */
        @media (orientation: landscape) {
            #info { top: auto; bottom: 5%; width: auto; padding: 5px 20px; }
            #direction-text { font-size: clamp(8rem, 35vh, 20rem); }
        }
    </style>
</head>
<body>

    <div id="info">
        <div id="mic-status">ğŸ”´ í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ê¶Œí•œ í—ˆìš©</div>
        <div>"ì‹œì‘", "ì •ì§€", "5ì´ˆ"</div>
        <div>í˜„ì¬: <span id="current-val" class="val">5</span>ì´ˆ (ë²”ìœ„: <span id="range-val" class="val">3~7</span>ì´ˆ)</div>
    </div>

    <div id="direction-text">READY</div>

    <script>
        // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').catch(() => {});
        }

        const directionDisplay = document.getElementById('direction-text');
        const currentValDisplay = document.getElementById('current-val');
        const rangeValDisplay = document.getElementById('range-val');
        const micStatus = document.getElementById('mic-status');
        
        let isRunning = false;
        let timer = null;
        let avgInterval = 5;
        let wakeLock = null;

        const directions = [
            { arrow: 'â†‘', label: 'ìœ„ë¡œ', color: '#2ecc71' },
            { arrow: 'â†“', label: 'ì•„ë˜ë¡œ', color: '#e74c3c' },
            { arrow: 'â†', label: 'ì™¼ìª½', color: '#3498db' },
            { arrow: 'â†’', label: 'ì˜¤ë¥¸ìª½', color: '#9b59b6' }
        ];

        // ìŒì„± ì¸ì‹ ì„¤ì •
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;
        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = true;
            recognition.lang = 'ko-KR';
            recognition.interimResults = false;

            recognition.onresult = (event) => {
                const cmd = event.results[event.results.length - 1][0].transcript.trim();
                if (cmd.includes("ì‹œì‘")) { if (!isRunning) toggleTraining(true); }
                else if (cmd.includes("ì •ì§€") || cmd.includes("ë©ˆì¶°")) { if (isRunning) toggleTraining(false); }
                else if (cmd.includes("ì´ˆ")) {
                    const num = parseInt(cmd.replace(/[^0-9]/g, ""));
                    if (num >= 3) { avgInterval = num; updateUI(); speak(`${avgInterval}ì´ˆ ì„¤ì • ì™„ë£Œ`); }
                }
            };

            recognition.onstart = () => { 
                micStatus.textContent = "ğŸŸ¢ Brave ìŒì„±ì¸ì‹ í™œì„±"; 
                micStatus.style.color = "#44bd32"; 
            };
            recognition.onend = () => { if(isRunning || micStatus.textContent.includes("í™œì„±")) recognition.start(); };
            recognition.onerror = (e) => { 
                if(e.error === 'not-allowed') alert("Brave ì„¤ì •ì—ì„œ ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.");
            };
        }

        function updateUI() {
            currentValDisplay.textContent = avgInterval;
            rangeValDisplay.textContent = `${avgInterval - 2}~${avgInterval + 2}`;
        }

        function runTraining() {
            if (!isRunning) return;
            const visual = directions[Math.floor(Math.random() * directions.length)];
            const audio = directions[Math.floor(Math.random() * directions.length)];
            
            directionDisplay.textContent = visual.arrow;
            document.body.style.backgroundColor = visual.color;

            if ("vibrate" in navigator) navigator.vibrate(150);
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(audio.label);
            utterance.lang = 'ko-KR';
            utterance.rate = 1.3;
            window.speechSynthesis.speak(utterance);

            const min = (avgInterval - 2) * 1000;
            const max = (avgInterval + 2) * 1000;
            const nextTime = Math.floor(Math.random() * (max - min + 1)) + min;
            timer = setTimeout(runTraining, Math.max(1200, nextTime));
        }

        async function toggleTraining(start) {
            if (start) {
                isRunning = true;
                if ('wakeLock' in navigator) { try { wakeLock = await navigator.wakeLock.request('screen'); } catch(e){} }
                runTraining();
            } else {
                isRunning = false;
                clearTimeout(timer);
                window.speechSynthesis.cancel();
                if (wakeLock) { wakeLock.release(); wakeLock = null; }
                directionDisplay.textContent = 'READY';
                document.body.style.backgroundColor = '#222';
            }
        }

        function speak(text) {
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'ko-KR';
            window.speechSynthesis.speak(u);
        }

        // Brave ë° S25 í„°ì¹˜ ëŒ€ì‘
        window.addEventListener('touchstart', () => {
            if (recognition && micStatus.textContent.includes("ğŸ”´")) {
                recognition.start();
                speak("ìŒì„± ì œì–´ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.");
            }
        }, { once: true });
    </script>
</body>
</html>
