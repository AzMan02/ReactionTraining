html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë°˜ì‘ í›ˆë ¨ Pro (Voice Control)</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --bg-color: #222; }
        body {
            margin: 0; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            height: 100vh; font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color); color: white;
            transition: background-color 0.15s ease-out; touch-action: manipulation;
        }
        #info { position: absolute; top: 10%; text-align: center; line-height: 1.6; z-index: 10; }
        #mic-status { color: #ff4757; font-weight: bold; margin-bottom: 5px; }
        #direction-text { font-size: 13rem; font-weight: 900; user-select: none; }
        .val { color: #fbc531; font-weight: bold; }
    </style>
</head>
<body>

    <div id="info">
        <div id="mic-status">ğŸ”´ í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ë§ˆì´í¬ í™œì„±í™”</div>
        <div>"ì‹œì‘", "ì •ì§€", "Nì´ˆ" (ì˜ˆ: 5ì´ˆ)</div>
        <div>í˜„ì¬ ì„¤ì •: <span id="current-val" class="val">5</span>ì´ˆ (ë²”ìœ„: <span id="range-val" class="val">3~7</span>ì´ˆ)</div>
    </div>

    <div id="direction-text">READY</div>

    <script>
	javascript
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').then(reg => {
            console.log('ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì„±ê³µ!');
        }).catch(err => {
            console.log('ë“±ë¡ ì‹¤íŒ¨:', err);
        });
    });
}
        const directionDisplay = document.getElementById('direction-text');
        const currentValDisplay = document.getElementById('current-val');
        const rangeValDisplay = document.getElementById('range-val');
        const micStatus = document.getElementById('mic-status');
        
        let isRunning = false;
        let timer = null;
        let avgInterval = 5; // ê¸°ë³¸ê°’ 5ì´ˆ
        let wakeLock = null;

        const directions = [
            { arrow: 'â†‘', label: 'ìœ„ë¡œ', color: '#2ecc71' },
            { arrow: 'â†“', label: 'ì•„ë˜ë¡œ', color: '#e74c3c' },
            { arrow: 'â†', label: 'ì™¼ìª½', color: '#3498db' },
            { arrow: 'â†’', label: 'ì˜¤ë¥¸ìª½', color: '#9b59b6' }
        ];

        // 1. ìŒì„± ì¸ì‹ ì„¤ì • (Web Speech API)
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.continuous = true;
        recognition.lang = 'ko-KR';

        recognition.onresult = (event) => {
            const cmd = event.results[event.results.length - 1].transcript.trim();
            if (cmd.includes("ì‹œì‘")) {
                if (!isRunning) toggleTraining(true);
            } else if (cmd.includes("ì •ì§€") || cmd.includes("ë©ˆì¶°")) {
                if (isRunning) toggleTraining(false);
            } else if (cmd.includes("ì´ˆ")) {
                const num = parseInt(cmd.replace(/[^0-9]/g, ""));
                if (num >= 3) { // ì•ë’¤ 2ì´ˆ í™•ë³´ë¥¼ ìœ„í•´ ìµœì†Œ 3ì´ˆ ê¶Œì¥
                    avgInterval = num;
                    updateUI();
                    speak(`í‰ê·  ${avgInterval}ì´ˆë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                }
            }
        };

        recognition.onstart = () => { micStatus.textContent = "ğŸŸ¢ ìŒì„± ì¸ì‹ ì¤‘..."; micStatus.style.color = "#44bd32"; };
        recognition.onend = () => { recognition.start(); }; // ìƒì‹œ ëŒ€ê¸°

        function updateUI() {
            currentValDisplay.textContent = avgInterval;
            rangeValDisplay.textContent = `${avgInterval - 2}~${avgInterval + 2}`;
        }

        // 2. í•µì‹¬ ë¡œì§: ì•ë’¤ 2ì´ˆ(ì´ 4ì´ˆ) ëœë¤ ê°„ê²©
        function runTraining() {
            if (!isRunning) return;

            const visual = directions[Math.floor(Math.random() * directions.length)];
            const audio = directions[Math.floor(Math.random() * directions.length)];

            directionDisplay.textContent = visual.arrow;
            document.body.style.backgroundColor = visual.color;

            if ("vibrate" in navigator) navigator.vibrate(200);
            
            // ìŒì„± ì¤‘ì²© ë°©ì§€
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(audio.label);
            utterance.lang = 'ko-KR';
            utterance.rate = 1.4;
            window.speechSynthesis.speak(utterance);

            // ëœë¤ ê³„ì‚°: (í‰ê·  - 2000ms) ~ (í‰ê·  + 2000ms)
            const min = (avgInterval - 2) * 1000;
            const max = (avgInterval + 2) * 1000;
            const nextTime = Math.floor(Math.random() * (max - min + 1)) + min;

            timer = setTimeout(runTraining, Math.max(1000, nextTime)); // ìµœì†Œ 1ì´ˆ ì•ˆì „ì¥ì¹˜
        }

        async function toggleTraining(start) {
            if (start) {
                isRunning = true;
                if ('wakeLock' in navigator) wakeLock = await navigator.wakeLock.request('screen');
                runTraining();
            } else {
                isRunning = false;
                clearTimeout(timer);
                window.speechSynthesis.cancel();
                if (wakeLock) wakeLock.release();
                directionDisplay.textContent = 'READY';
                document.body.style.backgroundColor = '#222';
            }
        }

        function speak(text) {
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'ko-KR';
            window.speechSynthesis.speak(u);
        }

        window.addEventListener('click', () => {
            recognition.start();
            speak("ìŒì„± ì œì–´ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.");
        }, { once: true });
    </script>
</body>
</html>